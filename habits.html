<!DOCTYPE html>
<html>
<head>
    <title> Focus Leveling - Habits</title>
    <style>
        h1 {
            color: rgb(76, 76, 196);

        }
        body {
            background-color: #0f0f1f;
            color: white;
            font-family: Arial;
            text-align: center;
            padding-top: 50px;
        }
        #habit-list {
            margin-top: 20px;
        }

        input {
            padding: 10px;
            font-size: 16px;
            border-radius: 10px;
            border: none;       
        }

        button {
            padding: 10px;
            font-size: 16px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
        }
        .habit {
            padding: 10px;
            background: #1f1f2f;
            border-radius: 10px;
            width: 300px;
            margin-left: auto;
            margin-right: auto;
            margin-top: 10px;
            text-align: center;

        }

        .habit label {
            flex-grow: 1;
            margin-left: 10px;

        }

        button.delete {
            background-color: crimson;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        #xp-container {
            width: 80%;
            margin: 20px auto;
            text-align: center;
        }

        #xp-bar {
            background-color: grey;
            height: 20px;
            width: 100%;
            border-radius: 10px;
            overflow: hidden;
        }

        #xp-fill {
            background-color: green;
            height: 100%;
            width: 0%;
            transition: width 0.4s;
        }

        #aibutton {
            color: white;
            background-color: #444;
            font-size: 12px;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 6px;

        }

        select {
            border-radius: 10px;
            padding: 5px;
        }
    </style>
</head>

<body>

        <h1 id="greeting"></h1>
        <p>Add a habit to track:</p>
        <input type="text" id="habitInput" placeholder="e.g Study for 30 mins"/>
        <button cursor="pointer" onclick="addHabit()">Add Habit</button>
            <select id="difficultySelect">
                <Option value="easy"> ðŸŸ¢Easy (10xp) </Option>
                <option value="medium">ðŸŸ¡Medium (20xp) </option>
                <option value="hard">ðŸ”´Hard (30xp) </option>
            </select>        
        <br><br>
        <button id="aibutton" onclick="startAISetup()">Need Help? Click Me!</button>

        <div id="xp-container">
            <p> XP: <span id="xp-value">0</span> / 100</p>
            <div id="xp-bar">
                <div id="xp-fill"></div>
            </div>
            <p id="level-up" style="color: lime; font-weight:bold;"></p>
        </div>


        <div id="habit-list"></div>

        <script>
            /* XP Bar */
            let xp = parseInt(localStorage.getItem("xp")) || 0; 
            updateXPBar();


            function toggleHabit(index) {
                const difficulty = habits[index].difficulty || "medium";
                const xpGain = difficulty == "easy" ? 10 : difficulty == "hard" ? 30: 20;

                if (!habits[index].done) {
                    xp += xpGain;
                    if (xp >= 100) {
                        xp = 0; //reset if over or = 100 xp
                        document.getElementById("level-up").innerText = "LEVEL Up!";
                        setTimeout(() => {
                            document.getElementById("level-up").innerText = "";
                        }, 2000);
                    }
                } else {
                    xp = Math.max(xp - xpGain, 0); // Removing a habit minuses 10 XP, but not below 0
                }

                habits[index].done = !habits[index].done; //Flipping done to not done    
                saveHabits();
                updateXPBar();
                renderHabits();
            } 

            function updateXPBar() {
                localStorage.setItem("xp", xp);
                document.getElementById("xp-value").innerText = xp; // show num
                document.getElementById("xp-fill").style.width = xp + "%"; //Fill bar to match XP
            }


            const habitList = document.getElementById("habit-list");
            const username = localStorage.getItem("username") || "Adventurer";
            document.getElementById("greeting").innerText = `Welcome Player ${username.toUpperCase()}!`;
            
            //Loading saved habits:
            let habits = JSON.parse(localStorage.getItem("habits")) || [];
            renderHabits();

            //Ading Habits:
            function addHabit() {
                const input = document.getElementById("habitInput"); 
                const habitText = input.value.trim();
                if (habitText == "")return;



                const difficulty = document.getElementById("difficultySelect").value;
                if (!["easy", "medium", "hard", "e", "m", "h"].includes(difficulty)) {
                    alert("Invalid Difficulty. Habit not addedd");
                    return;
                }
                habits.push({ text:habitText, done: false, difficulty});

                saveHabits(); //stores updated list in local storage
                renderHabits(); //screen update
                input.value = "";    //clears input box
            }

            function deleteHabit(index) {
                habits.splice(index, 1)
                saveHabits();
                renderHabits();
            }

            function saveHabits(){
                localStorage.setItem("habits", JSON.stringify(habits));
            }

  
            function renderHabits(){
                habitList.innerHTML = ""; // Clear current list

                habits.forEach((habit, index) => {
                    const div = document.createElement("div");
                    div.className = "habit";

                    const checkbox = document.createElement("input");
                    checkbox.type = "checkbox";
                    checkbox.checked = habit.done;
                    checkbox.onclick = () => toggleHabit(index);

                    const label = document.createElement("label");
                    label.textContent = habit.text;
                    label.textContent += `[${habit.difficulty || "medium"}]`;

                    if (habit.done) {
                        label.style.textDecoration = "line-through";
                    }

                    const deleteBtn = document.createElement("button");
                    deleteBtn.className = "delete";
                    deleteBtn.textContent = "Delete";
                    deleteBtn.onclick = () => deleteHabit(index);

                    div.appendChild(checkbox);
                    div.appendChild(label);
                    div.appendChild(deleteBtn);

                    habitList.appendChild(div);
                });
            }

            //"AI JS"
            function startAISetup() {
                const userGoal = prompt("What are your current goals right now?");
                if (!userGoal) return;
                
                const goal = userGoal.toLowerCase();
                const suggestions = [];

                if ((goal.includes("study")) || goal.includes("studying")) suggestions.push("Study for 30 mins");
                if ((goal.includes("gym")) || goal.includes("gyming")) suggestions.push("Gym 1 hour");
                if ((goal.includes("read")) || goal.includes("reading")) suggestions.push("Read 10 pages");

                if (suggestions.length == 0) {
                    alert("Sorry, I didn't detect any goals. Try again with specific terms: like gym/study/read");
                    return;
                }

                    suggestions.forEach(habit =>{
                        habits.push({ text: habit, done: false});
                    });

                    saveHabits();
                    renderHabits();
                    alert("Starter Habits Have Been Added Based on Goals!");

            }
    </script>
</body>
</html>
